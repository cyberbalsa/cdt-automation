# ==============================================================================
# ANSIBLE CONFIGURATION FILE
# ==============================================================================
# This file configures how Ansible connects to your lab environment
# Students: Read through the comments to understand each setting

[defaults]
# Where to find the inventory (list of hosts/VMs)
# This file is auto-generated by import-tofu-to-ansible.py
inventory = inventory/production.ini

# Disable SSH host key checking (safe in isolated lab environments)
# In production, you'd want this enabled for security
host_key_checking = False

# Don't create .retry files when playbooks fail
retry_files_enabled = False

# Show output in a more readable format
stdout_callback = yaml

# Reduce deprecation warnings (keeps output cleaner for learning)
deprecation_warnings = False

# Timeout for gathering facts (increase if VMs are slow)
gather_timeout = 30

# Path to roles directory (relative to ansible directory)
roles_path = roles

# Configure where to find group_vars/host_vars when playbooks are in subdirectories
# 'top' means look in the top-level directory (ansible/) for group_vars/host_vars
playbook_vars_root = top

# Pipelining reduces the number of connection operations required to execute a module on the remote server, by executing many Ansible modules without actual file transfers.
pipelining = True

[vars_host_group_vars]
# Load group_vars and host_vars at all stages (inventory + task demand)
stage = all

[ssh_connection]
# ==============================================================================
# SSH JUMP HOST CONFIGURATION
# ==============================================================================
# All connections route through ssh.cyberrange.rit.edu as a jump host
# This is necessary because the lab VMs are behind a firewall
#
# How it works:
# 1. Ansible connects to ssh.cyberrange.rit.edu first
# 2. From there, it jumps to the target VM's floating IP
# 3. This allows secure access to isolated lab networks
ssh_args = -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand="ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p sshjump@ssh.cyberrange.rit.edu" -o ServerAliveInterval=60 -o ServerAliveCountMax=3

# Keep connections alive to speed up playbook execution
pipelining = True
