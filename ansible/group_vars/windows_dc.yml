---
# ==============================================================================
# DOMAIN CONTROLLER SPECIFIC VARIABLES
# ==============================================================================
# These settings ONLY apply to the domain controller (first Windows VM)
# Students: This is where you configure the "heart" of the Windows domain
#
# DOCUMENTATION LINKS:
# - AD DS Overview: https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview
# - Windows Features: https://learn.microsoft.com/en-us/windows-server/administration/server-manager/install-or-uninstall-roles-role-services-or-features
# - Install-ADDSForest: https://learn.microsoft.com/en-us/powershell/module/addsdeployment/install-addsforest

# ------------------------------------------------------------------------------
# DOMAIN CONTROLLER ROLES AND FEATURES
# ------------------------------------------------------------------------------
# Windows features needed for Active Directory Domain Services (AD DS)
# Docs: https://learn.microsoft.com/en-us/windows-server/administration/server-manager/install-or-uninstall-roles-role-services-or-features

dc_features:
  - name: AD-Domain-Services       # Core AD DS role - stores directory data, handles authentication
    state: present                 # Docs: https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/
    include_management_tools: true
    include_sub_features: true

  - name: DNS                      # DNS server - required for AD to work (stores SRV records)
    state: present                 # Docs: https://learn.microsoft.com/en-us/windows-server/networking/dns/dns-top
    include_management_tools: true

  - name: RSAT-AD-Tools            # Remote Server Admin Tools - GUI management consoles
    state: present                 # Includes: AD Users & Computers, AD Sites & Services, etc.
    include_management_tools: true

  - name: RSAT-DNS-Server          # DNS Manager GUI for managing DNS zones and records
    state: present

# ------------------------------------------------------------------------------
# DOMAIN SERVICES CONFIGURATION
# ------------------------------------------------------------------------------
# Students: These control how the domain controller operates

# Automatically restart if required after feature installation
dc_auto_reboot: true

# Wait for AD services to be fully ready before continuing
dc_wait_for_services: true

# Timeout for waiting (in seconds)
dc_wait_timeout: 600

# ------------------------------------------------------------------------------
# DNS FORWARDERS
# ------------------------------------------------------------------------------
# DNS servers to forward queries to (for internet resolution)
# Students: In attack scenarios, you could point this to a rogue DNS server!

dns_forwarders:
  - 8.8.8.8      # Google DNS
  - 1.1.1.1      # Cloudflare DNS

# ------------------------------------------------------------------------------
# ATTACK SURFACE CONFIGURATION
# ------------------------------------------------------------------------------
# Students: These create intentional vulnerabilities for practice

# Enable SMBv1 (vulnerable to EternalBlue and other attacks)
# WARNING: This is intentionally insecure for learning purposes!
enable_smbv1: true

# Enable LLMNR/NetBIOS (vulnerable to responder attacks)
enable_llmnr: true
enable_netbios: true

# Weak password policy (easier to crack for practice)
# Set this to false for defense exercises
weak_password_policy: true

# ------------------------------------------------------------------------------
# LOGGING AND AUDITING
# ------------------------------------------------------------------------------
# Students: Enable these to practice log analysis and SIEM integration

# Enable detailed logging
enable_detailed_logging: false

# Audit policies to enable (for defense practice)
# audit_policies:
#   - category: Logon/Logoff
#     success: true
#     failure: true
#   - category: Object Access
#     success: true
#     failure: true
