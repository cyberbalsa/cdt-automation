---
# ==============================================================================
# SCORING ENGINE CONFIGURATION
# ==============================================================================
# This file configures the DWAYNE-INATOR-5000 scoring engine for your competition.
#
# WHAT IS A SCORING ENGINE?
# In Capture The Flag (CTF) and Collegiate Cyber Defense Competition (CCDC)
# style events, a scoring engine automatically checks if services (like websites,
# email servers, etc.) are running correctly. Teams earn points when their
# services are up and working, and lose points when services go down.
#
# COMPETITION ROLES:
# - Grey Team: Runs the competition infrastructure (that's you!)
# - Blue Team: Defenders who keep services running and secure
# - Red Team: Attackers who try to break into Blue Team systems
#
# HOW TO USE THIS FILE:
# 1. Edit the settings below to match your competition
# 2. Run: ansible-playbook playbooks/setup-scoring-engine.yml
# 3. Access the web scoreboard at http://<scoring-server-ip>:8080
#
# ANSIBLE VARIABLES EXPLAINED:
# Variables defined here (like scoring_event_name) are automatically
# available in playbooks and templates. Ansible loads all .yml files
# from group_vars/ based on which hosts are being configured.
#
# DOCUMENTATION:
# - Ansible Variables: https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html
# - DWAYNE-INATOR-5000: https://github.com/DSU-DefSec/DWAYNE-INATOR-5000
# ==============================================================================

# ------------------------------------------------------------------------------
# EVENT SETTINGS
# ------------------------------------------------------------------------------
# Basic information about your competition.

# The name shown on the scoreboard
scoring_event_name: "CDT Attack/Defend Competition"

# Timezone for timestamps on the scoreboard
# Find yours at: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
scoring_timezone: "America/New_York"

# Start with scoring paused? (true = paused, false = running immediately)
# TIP: Set to true so you can verify everything works before starting the clock
scoring_start_paused: false

# Show detailed information to competitors on the scoreboard
scoring_verbose: true

# Web interface port (default: 8080)
# Access scoreboard at: http://<server-ip>:8080
scoring_port: 8080

# ------------------------------------------------------------------------------
# TIMING SETTINGS
# ------------------------------------------------------------------------------
# Control how often services are checked and how points are calculated.
#
# EXAMPLE SCENARIO:
# With delay=60 and timeout=10, the engine checks each service every ~60 seconds.
# If a service doesn't respond within 10 seconds, that check fails.
# After 5 failed checks (sla_threshold), the team gets an SLA violation penalty.

# Seconds between service checks (how often to test each service)
scoring_delay: 60

# Random variation added to delay (prevents predictable check timing)
# This stops teams from "gaming" the system by only having services up during checks
scoring_jitter: 5

# How long to wait for a service to respond before marking it as down
scoring_timeout: 10

# Points awarded for each successful service check
scoring_service_points: 10

# SLA = Service Level Agreement
# How many consecutive failed checks before triggering an SLA violation
# Think of it like "three strikes and you're out" but for service uptime
scoring_sla_threshold: 5

# Penalty points deducted for an SLA violation
scoring_sla_points: 10

# ------------------------------------------------------------------------------
# ADMIN ACCOUNTS
# ------------------------------------------------------------------------------
# Admin users can:
# - View all team scores and detailed logs
# - Start/pause/reset the competition
# - Grade inject submissions (manual challenges)
#
# SECURITY NOTE: Change these passwords for real competitions!
# These are just defaults for lab/training use.

scoring_admins:
  - name: admin
    password: "ScoringAdmin123!"

# ------------------------------------------------------------------------------
# TEAMS
# ------------------------------------------------------------------------------
# Define the teams competing in your event.
#
# SINGLE TEAM MODE (this config):
# One Blue Team defends all the boxes. Good for training and practice.
#
# MULTI-TEAM MODE (advanced):
# Multiple Blue Teams each defend their own copy of the infrastructure.
# Requires separate network ranges per team (e.g., Team1: 10.10.1.x, Team2: 10.10.2.x)
#
# The 'id' field identifies the team. In multi-team setups, this replaces
# the 'x' in IP addresses (e.g., 10.10.x.21 becomes 10.10.1.21 for team "1")

scoring_teams:
  - id: "1"
    password: "BlueTeam123!"   # Teams use this to log in and change service passwords

# ------------------------------------------------------------------------------
# CREDENTIAL LISTS
# ------------------------------------------------------------------------------
# Define username/password combinations that the scoring engine uses to
# test services. These simulate real users trying to access services.
#
# WHY CREDENTIAL LISTS?
# The scoring engine needs to log into services (SSH, Windows, databases)
# to verify they're working. These credentials must match what's actually
# configured on the target systems.
#
# IMPORTANT FOR BLUE TEAMS:
# - Teams CAN change passwords during competition (to lock out attackers)
# - Teams CANNOT add new users or change usernames
# - When a team changes a password, they update it in the scoring web interface
#
# MULTIPLE LISTS:
# Different services may use different accounts. For example:
# - "domain_users" for regular user logins
# - "admins" for administrative access
# - "linux_users" for Linux-specific accounts

scoring_credlists:
  # Regular domain users (these are created by the create-domain-users.yml playbook)
  - name: "domain_users"
    usernames:
      - jdoe
      - asmith
      - bwilson
      - mjohnson
      - dlee
    default_password: "UserPass123!"

  # Windows Administrator account
  - name: "admins"
    usernames:
      - Administrator
    default_password: "Cyberrange123!"

  # Linux local user account (created by cloud-init during VM deployment)
  - name: "linux_users"
    usernames:
      - cyberrange
    default_password: "Cyberrange123!"

# ------------------------------------------------------------------------------
# FLAG SYSTEM CONFIGURATION (Attack/Defend Mechanics)
# ------------------------------------------------------------------------------
# The flag system adds attack/defend mechanics to your competition!
#
# HOW IT WORKS:
# 1. Red Team compromises a box and plants a flag file containing the token
# 2. Scoring engine checks if flag.txt contains the token
# 3. If the flag is valid, Red Team earns points!
# 4. Blue Team must hunt for and remove flag files

# Red team token for flag validation
# This token must appear in flag files for Red Team to score points
# Change this for each competition!
red_team_token: "REDTEAM-CTF-2026"

# ==============================================================================
# BOX CONFIGURATIONS
# ==============================================================================
# Box configurations are now AUTO-GENERATED from OpenTofu service_hosts.
#
# HOW IT WORKS:
# 1. Define services in opentofu/variables.tf -> service_hosts
# 2. Run: tofu apply && python3 import-tofu-to-ansible.py
# 3. Inventory sets host_services variable on each host
# 4. dwayne.conf.j2 template generates [[box]] entries automatically
#
# TO CUSTOMIZE CHECKS:
# - Default checks: ansible/group_vars/scoring_services.yml
# - Per-box overrides: ansible/group_vars/scoring_overrides.yml
#
# See docs/plans/2026-01-19-service-mapping-design.md for full documentation.
# ==============================================================================
